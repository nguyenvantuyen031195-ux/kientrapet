-- ======================================================
-- PH·∫¶N 1: DEHASH SYSTEM & AUTO CLAIM (CH·∫†Y ƒê·ªòC L·∫¨P)
-- ======================================================
task.spawn(function()
    local success_dehash, Router = pcall(function()
        return require(game.ReplicatedStorage.ClientModules.Core.RouterClient.RouterClient)
    end)
    
    local API = game.ReplicatedStorage:WaitForChild("API")

    if success_dehash then
        -- Gi·∫£i m√£ to√†n b·ªô Remote v·ªÅ t√™n g·ªëc
        pcall(function()
            table.foreach(debug.getupvalue(Router.init, 7), function(name, remote)
                if typeof(remote) == "Instance" then remote.Name = name end
            end)
        end)
        print("Dehash System: Th√†nh c√¥ng!")
    end

    -- H√†m ƒëi·ªÉm danh (1 - 25)
    print("Starting Advent Claim (1-25)...")
    for day = 1, 25 do
        pcall(function()
            -- Sau khi Dehash, WaitForChild s·∫Ω t√¨m ƒë∆∞·ª£c t√™n g·ªëc
            local r = API:WaitForChild("WinterEventAPI/AdventCalendarTryTakeReward", 2)
            if r then 
                r:InvokeServer(day)
                print("Advent System: ƒê√£ nh·∫≠n ng√†y " .. day)
            end
        end)
        task.wait(1)
    end
    print("Advent System: Ho√†n t·∫•t 25 ng√†y!")
end)


-- ======================================================
-- PH·∫¶N 2: MRS WHISKERPIPS MONITOR (GUI ƒê·ªòC L·∫¨P)
-- ======================================================
task.wait(5)

local player = game.Players.LocalPlayer
local TARGET_PET = "winter_2025_mrs_whiskerpips"
local CHECK_INTERVAL = 30 
local startTime = os.time()

-- Module d·ªØ li·ªáu
local ClientDataModule = require(game.ReplicatedStorage:WaitForChild("ClientModules"):WaitForChild("Core"):WaitForChild("ClientData"))

-- GIAO DI·ªÜN
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "PetMonitor_FullScreen"
ScreenGui.ResetOnSpawn = false
ScreenGui.IgnoreGuiInset = true 
ScreenGui.DisplayOrder = 999999
ScreenGui.Parent = (gethui and gethui()) or game:GetService("CoreGui")

-- N·ªÅn Background
local Background = Instance.new("Frame")
Background.Name = "Background"
Background.Parent = ScreenGui
Background.Size = UDim2.new(1, 0, 1, 0)
Background.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Background.BorderSizePixel = 0
Background.Visible = true 

-- B·ªë c·ª•c ch·ªØ
local UIList = Instance.new("UIListLayout")
UIList.Parent = Background
UIList.HorizontalAlignment = Enum.HorizontalAlignment.Center
UIList.VerticalAlignment = Enum.VerticalAlignment.Center
UIList.Padding = UDim.new(0.05, 0)

local PetStatusLabel = Instance.new("TextLabel")
local TimeLabel = Instance.new("TextLabel")

local function setupLabel(label, name)
    label.Name = name
    label.Parent = Background
    label.Size = UDim2.new(0.9, 0, 0.2, 0)
    label.BackgroundTransparency = 1
    label.Font = Enum.Font.FredokaOne
    label.TextScaled = true
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.RichText = true
end

setupLabel(PetStatusLabel, "PetStatus")
setupLabel(TimeLabel, "TimeStatus")

-- N√öT B·∫¨T/T·∫ÆT (TOGGLE BUTTON)
local ToggleBtn = Instance.new("TextButton")
ToggleBtn.Name = "ToggleButton"
ToggleBtn.Parent = ScreenGui
ToggleBtn.Size = UDim2.new(0, 50, 0, 50)
ToggleBtn.Position = UDim2.new(0, 10, 0, 10) 
ToggleBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
ToggleBtn.Text = "üëÅÔ∏è"
ToggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleBtn.TextSize = 25
ToggleBtn.ZIndex = 1000001 -- ƒê·∫£m b·∫£o lu√¥n n·∫±m tr√™n Background

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0.5, 0)
UICorner.Parent = ToggleBtn

ToggleBtn.MouseButton1Click:Connect(function()
    Background.Visible = not Background.Visible
    if Background.Visible then
        ToggleBtn.Text = "üëÅÔ∏è"
        ToggleBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    else
        ToggleBtn.Text = "‚ùå"
        ToggleBtn.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
    end
end)

-- LOGIC KI·ªÇM TRA PET
local function CheckForPet()
    local success, data = pcall(function()
        return ClientDataModule.get_data()[player.Name]
    end)

    if success and data and data.inventory and data.inventory.pets then
        for _, petData in pairs(data.inventory.pets) do
            if petData.id == TARGET_PET then
                return true
            end
        end
    end
    return false
end

-- V√≤ng l·∫∑p c·∫≠p nh·∫≠t Pet & M√†u n·ªÅn
task.spawn(function()
    while true do
        local isFound = CheckForPet()
        
        if isFound then
            Background.BackgroundColor3 = Color3.fromRGB(0, 120, 0) 
            PetStatusLabel.Text = "MRS WHISKERPIPS: <b>YES ‚úÖ</b>"
        else
            Background.BackgroundColor3 = Color3.fromRGB(120, 0, 0) 
            PetStatusLabel.Text = "MRS WHISKERPIPS: <b>NO ‚ùå</b>"
        end
        
        task.wait(CHECK_INTERVAL)
    end
end)

-- V√≤ng l·∫∑p c·∫≠p nh·∫≠t Th·ªùi gian ch·∫°y
task.spawn(function()
    while true do
        local elapsed = os.time() - startTime
        local h = math.floor(elapsed / 3600)
        local m = math.floor((elapsed % 3600) / 60)
        local s = elapsed % 60
        
        TimeLabel.Text = string.format("TIME: %02d:%02d:%02d", h, m, s)
        task.wait(1)
    end
end)
